#class $mod_name open;

#alias {${mod_name}_load} {
    #showme module $mod_name loaded;
    #unalias ${mod_name}_load;
};

#alias {${mod_name}_unload}{
    #showme module $mod_name unloaded.;
    #class $mod_name kill;
};



#alias {_tstmsg} {
    #showme <139>test : %0<079>;
};

#nop 武馆教头像是受宠若惊一样，说道：请教？这怎么敢当？;
#nop 武馆教头笑着说道：您见笑了，我这点雕虫小技怎够资格「指点」您什么？;
#nop 武馆教头说道：您太客气了，这怎么敢当？;


#alias {on_test_pass} {
    #alias cb_on_test_pass_true #cr;
    #alias cb_on_test_pass_false #cr;
    
    #alias cb_on_test_pass_true {%1};
    #alias cb_on_test_pass_false {%2};
    
    #if {$tt == 1} {
        cb_on_test_pass_true;
    } {
        cb_on_test_pass_false;
    };
};
#alias {testa} {
    #var tt %1;
    on_test_pass {
        #show pass;
        #show test ok;
    } {
        #show fail;
        #show test failed;
    };
}

#act {^    %S({Silver|Gold})} {
    #if {"%2" == "Silver"} {
        get silver;
    };
    #elseif {"%2" == "Gold"} {
        get gold;
    };
};

#alis {hitlu} {
    #act {^{陆大有已经这样了你还要打，过分了点吧|你的杀气增加了}} {
        log 去忏悔;
        #untic hitlu;
        eat liang;
        goto 武庙;
        on_there {
            #act {^{你感觉心中的杀气渐渐消失|你心中已没有丝毫杀气|你心中一片平和，已经没有丝毫杀气}} {
                #unact {^{你感觉心中的杀气渐渐消失|你心中已没有丝毫杀气|你心中一片平和，已经没有丝毫杀气}};
                
                log 忏悔完毕;
                
                goto 春来;
                on_there {
                    #act {^{你端起桌上的粗茶碗，咕噜咕噜饮喝了几大口茶|你已经不渴了，还是别喝了}} {
                        #unact {^{你端起桌上的粗茶碗，咕噜咕噜饮喝了几大口茶|你已经不渴了，还是别喝了}};
                        log 喝水完毕;
                        
                        on_there {
                            log hitlu准备就绪;
                            #tic {hitlu}{eat liang;pu;hit lu}{30};
                        };  
                        #delay {1}{goto 客厅 华山};
                    };
                    #delay {1} {drink};
                };
            };
            chanhui;
        };
    };
};
#gag {^无 欢真希望看到你去死};

#act {^这项任务必须在%*分%*秒内完成} {
    #var time[limit] @eval{@eval{@ctd{%1} * 60} + @ctd{%2}};
    #var time[left] $time[limit];
    
    #tic {tk_countdown} {
        #if {$time[left] > 0} {
            #math time[left] {$time[left] - 1};
            
            status.set_action $time[left];
        } {
            #untic {tk_countdown};
            #unvar time;
            
            status.set_action 任务超时;
        };
    } {1};
};
#act {^你对%*的忠诚度提高了%*点} {
    #untic {tk_countdown};
    status.set_action 空闲;
};

#act {你需要先接受张三的挑战} {
    log zhangsan_come;
    accept zhang;
};
#act {^【江湖】张 三(Zhang san): 听说%*阁下武功不错，在下想与您较量一下。} {
    log zhangsan 挑战 %1;
};

#alias {get_time} {
    #act {现在现实中的时间是北京时间 %*} {
        #unact {现在现实中的时间是北京时间 %*};
        #var baowei[time] %%1;
        #show $baowei[time];
        
        #unvar baowei;
        #nop #system {echo -e "第$baowei[round]轮 $baowei[time]" >> data/baowei.log};
    };
    time;
};
#act {【江湖】听说侠客岛赏善使者莅临中原，邀请有缘人前往侠客岛一游！} {
    
};

#act {^你捡起一堆陨铁} {
    drop yun tie;
};
#act {^你有很长一段时间没有备份档案了} {
    backup;
};

#act {^MISSION_COMPLETE} {
    dztn;
};
    
#function {var}{
    #var result $%1;
};
#alias {on_test} {
    #show %1;
    #show %2;
    #show %3;
    #alias cb_on_test #cr;
    #alias cb_on_test %0;
    
    
    #var tt {test alias};
    cb_on_test;
};

#macro {\e[1;2A} {moven};
#macro {\e[1;2B} {moves};
#macro {\e[1;2C} {movee};
#macro {\e[1;2D} {movew};

#alias {xuexi.set} {
    #var xuexi[room] %1;
    #var xuexi[rest] %2;
};
#alias {xuexi} {
    #if {&xuexi[count] == 0} {
        #var xuexi[count] 5;
    };
    #if {"%2" != ""} {
        #var xuexi[teacher] %1;
        #var xuexi[skill] %2;
        #var xuexi[count] %3;
    };
    
    #class xuexi_inner open;
    #act {^你和师父切磋%*，消耗了大量潜能} {
        xuexi.stop;
    };
    #act {^也许是缺乏实战经验，你%*总是无法领会} {
        xuexi.stop;
    };
    #act {^你的潜能已经发挥到极限了，没有办法再成长了} {
        xuexi.stop;
    };
    #act {^你共请教了零次} {
        yun regenerate;
    };
    #act {^你的内力不够} {
        xuexi.stop;
        #delay {2} {
            #act {^你吃饱喝足，站了起来} {
                gt 休息室;
                #act {^你在三分钟内刚睡过} {
                    #delay {10} {
                        sleep;
                    };
                };
                #act {^你一觉醒来} {
                    goto $xuexi[room];
                    on_there {
                        xuexi;
                    };
                };
                on_there {
                    sleep;
                };
            };
            gt 斋堂;
            on_there {
                zuo;
            };
        };
    };
    #tic {tk_xuexi} {
        xue $xuexi[teacher] for $xuexi[skill] $xuexi[count];
    }{1};
    #class xuexi_inner close;
};
#alias {xuexi.stop} {
    #unact {^你吃饱喝足，站了起来};
    #unact {^你在三分钟内刚睡过};
    #unact {^你一觉醒来};
    #class xuexi_inner kill;
};

#alias {duoqi} {
    #tic {tk_duoqi} {
        duo;
    }{0.5};
};
#alias {duoqi.stop} {
    #untic {tk_duoqi};
};

#alias {get_hpbrief} {
    #act {#%d,%d,%d,%d{,战斗中|}$}{
        #line gag;
        
        #unact {#%d,%d,%d,%d{,战斗中|}$};
        
        #var hpbrief[zhenqi] %%1;
        #var hpbrief[zhenyuan] %%2;
        #var hpbrief[food] %%3;
        #var hpbrief[water] %%4;
        
        #if {"%%5" != ""} {
            #var hpbrief[fighting] 1;
        } {
            #var hpbrief[fighting] 0;
        };
        
        #buffer get hpbrief[buffer][input] 1 2;
        
        #var hpbrief[buffer][line2] $hpbrief[buffer][input][1];
        #var hpbrief[buffer][line1] $hpbrief[buffer][input][2];
        
        #regexp {$hpbrief[buffer][line1]}{^#%*,%d,%d,%d,%d,%d$} {
            #var hpbrief[exp] &1;
            #var hpbrief[pot] &2;
            #var hpbrief[neili_max] &3;
            #var hpbrief[neili] &4;
            #var hpbrief[jingli_max] &5;
            #var hpbrief[jingli] &6;
        };
        #regexp {$hpbrief[buffer][line2]}{^#%d,%d,%d,%d,%d,%d$} {
            #var hpbrief[hp_max] &1;
            #var hpbrief[hp_valid] &2;
            #var hpbrief[hp] &3;
            #var hpbrief[sp_max] &4;
            #var hpbrief[sp_valid] &5;
            #var hpbrief[sp] &6;
        };
        
        #nop #unvar hpbrief[buffer];
        #unact {^#};
    };
    #act {^#} {
        #line gag;
    }{6};
    #send hpbrief;
};

#alias {duizhao1} {

#show 你背着众人，悄悄地打开了旧纸;
#show ;
#show 1 2 3 4 5 6 7 8 9 1011;
#show 1 岛少之州丐山岸府山督手;
#show 2 州成江苗府泰灵麟日北真;
#show 3 南龙湖州苏帮康眉北庄安;
#show 4 路小宿村禁临州江东紫武;
#show 5 州山府源山禁苏天教阜湖;
#show 6 康大州府长洛轮武天临长;
#show 7 疆天当信慕临州石凌古疆;
#show 8 后天后河康天安嵋督明州;
#show 9 原中西桃宫量州寺府山禁;
#show 10神临江禁镇苏中州王教州;
#show ;
#show ;
};

    
#class $mod_name close;

${mod_name}_load;
